(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{264:function(e,t,n){!function(){function t(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function n(e,n,a){var i,r=new Promise(function(r,o){t(i=e[n].apply(e,a)).then(r,o)});return r.request=i,r}function a(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function i(e,t,a,i){i.forEach(function(i){i in a.prototype&&(e.prototype[i]=function(){return n(this[t],i,arguments)})})}function r(e,t,n,a){a.forEach(function(a){a in n.prototype&&(e.prototype[a]=function(){return this[t][a].apply(this[t],arguments)})})}function o(e,t,a,i){i.forEach(function(i){i in a.prototype&&(e.prototype[i]=function(){return function(e,t,a){var i=n(e,t,a);return i.then(function(e){if(e)return new c(e,i.request)})}(this[t],i,arguments)})})}function s(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function l(e){this._store=e}function u(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new u(n)}function p(e){this._db=e}a(s,"_index",["name","keyPath","multiEntry","unique"]),i(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),a(c,"_cursor",["direction","key","primaryKey","value"]),i(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(c.prototype[e]=function(){var n=this,a=arguments;return Promise.resolve().then(function(){return n._cursor[e].apply(n._cursor,a),t(n._request).then(function(e){if(e)return new c(e,n._request)})})})}),l.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},a(l,"_store",["name","keyPath","indexNames","autoIncrement"]),i(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),r(l,"_store",IDBObjectStore,["deleteIndex"]),u.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},a(u,"_tx",["objectStoreNames","mode"]),r(u,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},a(d,"_db",["name","version","objectStoreNames"]),r(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new u(this._db.transaction.apply(this._db,arguments))},a(p,"_db",["name","version","objectStoreNames"]),r(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[l,s].forEach(function(t){t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),a=n[n.length-1],i=this._store||this._index,r=i[e].apply(i,n.slice(0,-1));r.onsuccess=function(){a(r.result)}}})}),[s,l].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,a=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(a.push(e.value),void 0===t||a.length!==t?e.continue():i(a)):i(a)})})})});var m={open:function(e,t,a){var i=n(indexedDB,"open",[e,t]),r=i.request;return r.onupgradeneeded=function(e){a&&a(new d(r.result,e.oldVersion,r.transaction))},i.then(function(e){return new p(e)})},delete:function(e){return n(indexedDB,"deleteDatabase",[e])}};e.exports=m,e.exports.default=e.exports}()},272:function(e,t){e.exports="data:image/png;base64,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"},339:function(e,t,n){e.exports=n(686)},344:function(e,t,n){},356:function(e,t){},358:function(e,t){},397:function(e,t){},398:function(e,t){},400:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=400},602:function(e,t){},603:function(e,t){},675:function(e,t,n){},686:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(33),o=n.n(r),s=(n(344),n(10)),c=n(11),l=n(13),u=n(12),d=n(14),p=n(19),m=n(515),h=n(690),g=n(26),f=n(5),b=n.n(f),v=n(49),E=n.n(v),y=n(264),w=n.n(y).a.open("post-store",1,function(e){e.objectStoreNames.contains("posts")||e.createObjectStore("posts",{keyPath:"data"})}),A=function(e){return w.then(function(t){return t.transaction(e,"readonly").objectStore(e).getAll()})},j=function(e,t){var n=e.data,a=t.data,i=0;return n>a?i=-1:n<a&&(i=1),i},O=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getPosts=function(){var e=[];"indexedDB"in window&&A("posts").then(function(t){e.push(t),e=t.length>0?e[0].reverse():e,a.setState({posts:e,loaded:!0})}),new(n(120).default.JSONClient)("https://spot-pwa.firebaseio.com").get("/posts").then(function(t){e=[],e=Object.values(t.body).sort(j),a.setState({posts:e,loaded:!0})}).catch(function(e){return console.log(e)})},a.state={loaded:!1,posts:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getPosts()}},{key:"render",value:function(){return this.props.children(this.state.posts,this.state.loaded)}}]),t}(a.PureComponent),k=n(64),x=n.n(k),N=n(65),S=n.n(N),C=n(110),F=n.n(C),L=n(47),R=n.n(L),T=n(34),I=n.n(T),K=n(268),U=n.n(K),P=n(85),B=n.n(P);B.a.initializeApp({apiKey:"AIzaSyBot5tOfkhdUCvJsWh6sk--42syvvJwM4M",authDomain:"spot-pwa.firebaseapp.com",databaseURL:"https://spot-pwa.firebaseio.com",projectId:"spot-pwa",storageBucket:"spot-pwa.appspot.com",messagingSenderId:"968470527016"});new B.a.auth.GoogleAuthProvider;var Z=B.a.auth(),G=B.a,D=n(63),V=n.n(D),W=n(266),q=n.n(W),H=n(688),M="#FAFAFA",z="#EEEEEE",J="#212985",Y="#9D82C0",X="#EE2700",Q="#979797",_="#FFFFFF",$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleLike=function(e,t){return function(){var a=Z.currentUser;if(a){var i=a.uid,r=t.count,o=t.users?t.users:[],s=o.indexOf(i);s<0?(r++,o.push(i)):(r--,o.splice(s,1)),G.database().ref("posts/"+e).update({likes:{count:r,users:o}}),n.setState({likes:{count:r,users:o}})}else n.props.history.push("/login")}},n.state={likes:{count:0,users:[]}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({likes:this.props.likes})}},{key:"render",value:function(){var e=this.state.likes,t=this.props,n=t.id,a=t.classes,r=Z.currentUser,o=!(!r||!e.users)&&e.users.indexOf(r.uid)>=0;return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.a,{"aria-label":"Polajkuj",onClick:this.handleLike(n,e)},i.a.createElement(q.a,{className:o?a.liked:""})),i.a.createElement("span",{className:a.likes},e&&e.count))}}]),t}(a.Component),ee=Object(H.a)($),te=Object(g.withStyles)(function(e){return{likes:{fontSize:12,color:Q},liked:{color:X}}})(ee),ne=function(e){var t=new Date,n=new Date(e),a=n.getDate(),i=n.getMonth()+1;a<10&&(a="0"+a);var r=(t.getTime()-n.getTime())/1e3,o=Math.abs(Math.round(r/60)),s=function(e){return 1===e?"\u0119":e>1&&e<5?"y":""},c=o+" minut"+s(o)+" temu";if(o>=60&&o<1440){var l=Math.abs(Math.round(r/3600));c=l+" godzin"+s(l)+" temu"}else if(o>=1440){c=a+" "+["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrze\u015bnia","pa\u017adziernika","listopada","grudnia"][i-1]}return c},ae=n(165),ie=n.n(ae),re=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).getUserColor=function(e){var t=n.props.content.user.color;if(t)return t;n.usersRef=G.database().ref("users/"+e),n.usersRef.on("value",function(e){return e.val().color})},n.state={expanded:!1,time:null,color:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.content,t=e.user,n=this.getUserColor(t.id);this.setState({time:ne(e.data),color:n})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.content,a=this.state,r=a.time,o=a.color,s=n.id,c=n.user,l=n.img,u=n.geo,d=n.shortText,p=n.likes;return i.a.createElement(x.a,{className:t.card},i.a.createElement(S.a,{avatar:i.a.createElement(R.a,{className:t.avatar,style:{backgroundColor:o}},c&&c.name[0].toUpperCase()),title:c.name,subheader:r}),i.a.createElement(ie.a,{height:380},i.a.createElement("img",{src:l,alt:d,className:t.media})),i.a.createElement(F.a,{className:t.info},i.a.createElement("div",{style:{width:"80%"}},i.a.createElement("p",{className:t.localization},i.a.createElement(U.a,{className:t.iconGeo}),u),i.a.createElement(I.a,{component:"p"},d)),i.a.createElement("div",{style:{width:"20%"}},i.a.createElement(te,{likes:p,id:s}))))}}]),t}(i.a.Component),oe=Object(g.withStyles)(function(e){return{card:{maxWidth:500,borderRadius:0,boxShadow:"none",margin:"0 auto"},media:Object(p.a)({width:"100%",height:380,objectFit:"cover"},e.breakpoints.up("sm"),{paddingLeft:12,paddingRight:12}),actions:{display:"flex"},expand:Object(p.a)({transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),marginLeft:"auto"},e.breakpoints.up("sm"),{marginRight:-8}),expandOpen:{transform:"rotate(180deg)"},localization:{color:Q,fontSize:12,display:"flex",alignItems:"center"},iconGeo:{width:14,height:14},info:{display:"flex",justifyContent:"space-between"}}})(re),se=n(689),ce=n(495),le=n(81),ue=n.n(le),de=n(50),pe=n.n(de),me=n(269),he=n.n(me),ge=n(271),fe=n.n(ge),be=n(270),ve=n.n(be),Ee={root:{width:"100%",position:"fixed",bottom:0,left:0,boxShadow:"none",borderTop:"1px solid "+z,backgroundColor:M,zIndex:1},icon:{color:Y},button:{color:"inherit"},flex:{display:"flex",alignItems:"center"},textButton:{color:Y,textTransform:"uppercase",fontWeight:500,fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.875rem",lineHeight:"0.875rem"}},ye=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).renderCameraView=function(){var e=n.props,t=e.classes,a=e.handleSwitch,r=e.step,o=e.camera;return i.a.createElement(ue.a,{className:t.root},o&&i.a.createElement(pe.a,{className:b()(t.button,t.textButton+" "+(1===r&&"activeTextButton")),onClick:a(1),icon:"Zdj\u0119cie"}),i.a.createElement(pe.a,{className:b()(t.button,t.textButton+" "+(2===r&&"activeTextButton")),icon:"Galeria",onClick:a(2)}))},n.renderNormalView=function(){var e=n.props.classes;return i.a.createElement(ue.a,{className:e.root},i.a.createElement(pe.a,{className:e.button,label:"Home",icon:i.a.createElement(se.a,{to:"/",activeClassName:"iconactive",exact:!0,className:e.icon},i.a.createElement(he.a,null))}),i.a.createElement(pe.a,{label:"Add",className:e.button,icon:i.a.createElement(se.a,{to:"/add",activeClassName:"iconactive",exact:!0,className:e.icon},i.a.createElement(ve.a,null))}),i.a.createElement(pe.a,{label:"Profile",className:e.button,icon:i.a.createElement(se.a,{to:"/profile",activeClassName:"iconactive",exact:!0,className:e.icon},i.a.createElement(fe.a,null))}))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.location,n=e.loggedOut;return"/add"!==t.pathname||n?this.renderNormalView():this.renderCameraView()}}]),t}(i.a.Component),we=Object(ce.a)(ye),Ae=Object(g.withStyles)(Ee)(we),je=n(516),Oe=n(111),ke=n.n(Oe),xe=n(112),Ne=n.n(xe),Se=n(16),Ce=n(274),Fe=n.n(Ce),Le=n(273),Re=n.n(Le),Te=n(275),Ie=n.n(Te),Ke=n(272),Ue=n.n(Ke),Pe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).goBack=function(){n.props.history.goBack()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.location,a=e.handleSwitch,r=e.imgSent,o=e.step,s=e.singlePost,c=e.openActions,l=e.onlyBack,u=e.loggedOut;return i.a.createElement("div",{className:t.root},i.a.createElement(ke.a,{position:"fixed",className:t.appbar},i.a.createElement(Ne.a,{className:t.toolbar},!s&&!l&&i.a.createElement(je.a,{to:"/",className:t.logo},i.a.createElement("img",{src:Ue.a,alt:"",className:t.logoimage})),(s||l)&&!u&&i.a.createElement(Re.a,{className:t.link,onClick:this.goBack}),"/add"===n.pathname&&r&&3!==o&&!u&&i.a.createElement(Se.a,{className:t.link,onClick:a(3)},"Dalej"),"/add"===n.pathname&&r&&3===o&&!u&&i.a.createElement(Se.a,{className:t.link,onClick:a(1)},"Wr\xf3\u0107"),"/profile"===n.pathname&&!u&&i.a.createElement(je.a,{to:"/settings"},i.a.createElement(Fe.a,{className:t.link})),s&&c&&!u&&i.a.createElement(Ie.a,{className:t.link,onClick:c}))))}}]),t}(i.a.Component),Be=Object(ce.a)(Pe),Ze=Object(g.withStyles)(function(e){return{root:{flexGrow:1},appbar:{backgroundColor:M,boxShadow:"none",borderBottom:"1px solid "+z},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},logo:{display:"flex",alignItems:"center"},logoimage:{height:40},link:{color:J},lefticon:{marginRight:30},toolbar:Object(p.a)({justifyContent:"space-between"},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto"})}})(Be);var Ge=Object(g.withStyles)(function(e){return{layout:Object(p.a)({width:"auto",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto"}),cardGrid:{padding:"".concat(4*e.spacing.unit,"px 0 !important")},cardItemGrid:{padding:"0 !important"},cardItem:{width:"calc(100% + 48px)",margin:-24},center:{width:"100%",height:"100vh",position:"absolute",left:0,top:0,display:"flex",justifyContent:"center",alignItems:"center"}}})(function(e){var t=e.classes,n=e.auth;return i.a.createElement("div",{className:b()(t.layout,t.cardGrid)},i.a.createElement(Ze,null),i.a.createElement(O,{auth:n},function(e,n){return n?i.a.createElement(E.a,{container:!0,spacing:40,className:t.cardItem},e.length>0?e.map(function(e,n){return i.a.createElement(E.a,{item:!0,key:n,xs:12,sm:4,md:4,lg:4,className:t.cardItemGrid},i.a.createElement(oe,{content:e}))}):i.a.createElement(Se.j,{variant:"subheading",className:t.center},"Brak post\xf3w do wy\u015bwietlenia")):i.a.createElement("div",{className:t.center},i.a.createElement(Se.b,{className:t.progress,size:30,thickness:5}))}),i.a.createElement(Ae,null))}),De=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getPosts=function(e){var t=a.props.user.uid,i=[],r=[];"indexedDB"in window&&A("posts").then(function(e){for(var n in e)e[n].user.id===t&&i.push(e[n]),e[n].likes.users&&e[n].likes.users.indexOf(t)>=0&&r.push(e[n]);i=i.reverse(),r=r.reverse(),a.setState({posts:i,likes:r,loaded:!0})}),new(n(120).default.JSONClient)("https://spot-pwa.firebaseio.com",{auth:e}).get("/posts").then(function(e){for(var n in i=[],r=[],e.body)e.body[n].user.id===t&&i.push(e.body[n]),e.body[n].likes.users&&e.body[n].likes.users.indexOf(t)>=0&&r.push(e.body[n]);var a=[],o=i.sort(j),s=r.sort(j);return a.push(o),a.push(s),a}).then(function(e){var t=e[0],n=e[1];a.setState({posts:t,likes:n,loaded:!0})}).catch(function(e){return console.log(e)})},a.state={loaded:!1,likes:[],posts:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authFirebaseListener=Z.onAuthStateChanged(function(t){t&&t.getIdToken().then(function(t){e.getPosts(t)})})}},{key:"render",value:function(){return this.props.children(this.state.posts,this.state.likes,this.state.loaded)}}]),t}(a.PureComponent),Ve=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).switchView=function(e){return function(){n.setState({view:e})}},n.getUserColor=function(e){n.usersRef=G.database().ref("users/"+e),n.usersRef.on("value",function(e){n.setState({color:e.val().color})})},n.renderList=function(e){var t=n.props.classes;return i.a.createElement(Se.f,{spacing:0,className:t.gridList},e.length>0?e.map(function(e,n){return i.a.createElement(Se.g,{cols:window.innerWidth>1100?.6666:1,key:n,className:t.gridListTile},i.a.createElement(je.a,{to:"/post/"+e.id,className:t.gridListLink},i.a.createElement("img",{src:e.img,alt:e.shortText,className:t.gridImg})))}):i.a.createElement("div",{className:t.center},i.a.createElement(Se.j,{variant:"subheading"},"Brak post\xf3w do wy\u015bwietlenia")))},n.state={view:"posts",color:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.user;this.getUserColor(e.uid)}},{key:"renderPostsCounter",value:function(e,t){var n=this.props.classes,a=this.state.view,r=0===e.length?0:e,o=0===t.length?0:t;return i.a.createElement("div",{className:n.postCounter},i.a.createElement("div",{className:b()(n.postCounterButton,"posts"===a?n.buttonActive:""),onClick:this.switchView("posts")},i.a.createElement(Se.j,{variant:"overline",className:n.heading},"Moje posty"),i.a.createElement(Se.j,{variant:"overline",className:n.counter},r)),i.a.createElement("div",{className:b()(n.postCounterButton,"likes"===a?n.buttonActive:""),onClick:this.switchView("likes")},i.a.createElement(Se.j,{variant:"overline",className:n.heading},"Polubione"),i.a.createElement(Se.j,{variant:"overline",className:n.counter},o)))}},{key:"render",value:function(){var e=this,t=this.state,n=t.view,a=t.color,r=this.props,o=r.classes,s=r.user;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,null),i.a.createElement(x.a,{className:o.profile},i.a.createElement(S.a,{avatar:i.a.createElement(R.a,{className:o.avatar,style:{backgroundColor:a}},s.displayName?s.displayName[0].toUpperCase():""),title:s?s.displayName:"",subheader:s?s.email:""})),i.a.createElement("div",{className:o.layout},i.a.createElement(De,{user:s},function(t,a,r){return r?i.a.createElement(i.a.Fragment,null,e.renderPostsCounter(t.length,a.length),"posts"===n?e.renderList(t):e.renderList(a)):i.a.createElement(i.a.Fragment,null,e.renderPostsCounter(0,0),i.a.createElement("div",{className:o.center},i.a.createElement(Se.b,{className:o.progress,size:30,thickness:5})))})),i.a.createElement(Ae,null))}}]),t}(a.PureComponent),We=Object(g.withStyles)(function(e){return{profile:Object(p.a)({borderRadius:0,boxShadow:"none"},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto",marginBottom:15}),layout:Object(p.a)({},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto"}),heading:{lineHeight:"1em",color:Q,marginBottom:5,marginTop:15},counter:{lineHeight:"1em",marginBottom:15},gridList:{margin:"0 !important",overflow:"visible"},postCounter:{border:"1px solid "+z,textAlign:"center"},postCounterButton:{width:"50%",borderRight:"1px solid "+z,display:"inline-block",boxSizing:"border-box"},buttonActive:{background:M},center:{width:"100% !important",height:"100vh !important",zIndex:-1,position:"absolute",left:0,top:0,display:"flex",justifyContent:"center",alignItems:"center"},gridImg:{objectFit:"cover",width:"100%",height:"100%",position:"absolute",top:0,left:0,bottom:0,right:0},gridListTile:{height:"initial !important",position:"relative",width:"100%",overflow:"hidden",background:J},gridListLink:{display:"block",paddingTop:"100%"}}})(Ve),qe=n(276),He=n(166),Me=n.n(He),ze=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),i=new Uint8Array(a),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([a],{type:n})},Je=n(277),Ye=n.n(Je),Xe=function(e){return{captureButton:{fontSize:"46px"}}},Qe=f.bind(Xe),_e=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).detectMobile=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},n.turnOnCamera=function(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){n.videoStream.srcObject=e,n.setState({globalStream:e});var t=e.getVideoTracks()[0].getSettings().height,a=e.getVideoTracks()[0].getSettings().width;n.detectMobile()?n.setState({cameraHeight:a,cameraWidth:t}):n.setState({cameraHeight:t,cameraWidth:a})}).catch(function(e){console.log(e)})},n.turnOffCamera=function(){n.state.globalStream&&n.state.globalStream.getTracks()[0].stop()},n.state={elementHeight:300,cameraHeight:null,cameraWidth:null,elementWidth:null,globalStream:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.camera&&(this.turnOnCamera(),this.timeout=setTimeout(function(){var t=e.divRef?e.divRef.offsetHeight:0,n=t*e.state.cameraWidth/e.state.cameraHeight;e.setState({elementHeight:t,elementWidth:n})},1e3))}},{key:"componentWillUnmount",value:function(){this.turnOffCamera(),clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.captureImage,r=t.imgSent,o=this.state,s=o.elementHeight,c=o.elementWidth,l=Qe({video:!0,hidden:r}),u=Qe({canva:!0,hidden:!r}),d=Qe({captureButton:!0,hidden:r});return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"video-container",ref:function(t){return e.divRef=t}},i.a.createElement("video",{className:l,autoPlay:!0,ref:function(t){e.videoStream=t},height:s,width:c}),i.a.createElement("canvas",{className:u,ref:function(t){e.canvas=t},height:s,width:c})),i.a.createElement(Se.a,{className:d,color:"primary",type:"button",onClick:a(this.canvas,this.videoStream),ref:function(t){e.captureButton=t}},i.a.createElement(Ye.a,{className:n.captureButton})))}}]),t}(a.PureComponent),$e=Object(g.withStyles)(Xe)(_e),et=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.handleChange,a=e.values;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Se.i,{id:"outlined-name",label:"Podpis",className:t.textField,value:a.shortText,onChange:n("shortText"),margin:"normal",variant:"outlined"}),i.a.createElement(Se.i,{id:"outlined-name",label:"Lokalizacja",className:t.textField,value:a.geo,onChange:n("geo"),margin:"normal",variant:"outlined"}))}}]),t}(a.PureComponent),tt=Object(g.withStyles)(function(e){return{textField:{width:"100%"},button:{width:"100%",marginTop:2*e.spacing.unit}}})(et),nt=n(48),at=n.n(nt),it=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).showImage=function(e){n.setState({file:URL.createObjectURL(e.target.files[0])})},n.state={file:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.handleAddFile;return i.a.createElement("div",{id:"pick-image"},this.state.file?i.a.createElement("img",{className:n.preview,src:this.state.file,alt:"podgl\u0105d"}):"",i.a.createElement("input",{accept:"image/*",className:n.input,id:"image-picker",onChange:function(t){e.showImage(t),a(t)},type:"file"}),i.a.createElement("label",{htmlFor:"image-picker",className:n.label},i.a.createElement(at.a,{variant:"contained",component:"span",className:n.button},"Wybierz zdj\u0119cie")))}}]),t}(a.Component),rt=Object(g.withStyles)(function(e){return{button:{margin:e.spacing.unit,marginTop:30},input:{display:"none"},label:{width:"100%",display:"block",textAlign:"center"},preview:{width:"100%"}}})(it),ot=n(167),st=n.n(ot),ct=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){return function(t){n.setState(Object(p.a)({},e,t.target.value))}},n.handleAddFile=function(e){n.setState({img:e.target.files[0],imgSent:!0})},n.handleSend=function(){var e=n.state,t=e.user,a=e.img,i=e.geo,r=e.shortText,o=e.subscriptions;n.setState({loaded:!1});var s=Me()(),c=Me()(),l=G.storage().ref().child("images").child(s),u=(new Date).getTime();l.put(a).then(function(){return l.getDownloadURL().then(function(e){var a=G.database().ref("posts/"+c),l={id:c,imageid:s,user:t,data:u,img:e,geo:i,shortText:r,likes:{count:0}};a.set(l).then(function(){fetch("https://us-central1-spot-pwa.cloudfunctions.net/sendNotifications",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({from:t,subscriptions:o})})}),n.setState({id:"",imageId:"",data:"",img:"",geo:"",shortText:"",loaded:!0}),n.props.history.goBack()}),!0}).catch(function(e){n.setState({loaded:!0}),console.log(e)})},n.sendNotifications=function(){st.a.setVapidDetails("mailto:test@test.pl","BCpge7IV7kIBHpMQ1ahqFVC0TzobN3sqkN_C5hk3LTrU5ytxj4o2ozTA_vxU-ZHZW8HW0Ldw9JJPfLX6hg-lPkA","52hq0m6auAORzXwI46Os-a6wyxvKtH5B2-IkVfXn2JE"),n.state.subscriptions.forEach(function(e){var t={endpoint:e.endpoint,keys:{auth:e.keys.auth,p256dh:e.keys.p256dh}};st.a.sendNotification(t,JSON.stringify({title:"Nowy post na Spotick!",constent:"Kto\u015b wrzuci\u0142 nowe zdj\u0119cie, zobacz jakie!"}))})},n.getSubscriptions=function(){n.usersRef=G.database().ref("users");var e=[];n.usersRef.on("value",function(t){t.forEach(function(t){t.val().subscription&&e.push(t.val().subscription)}),n.setState({subscriptions:e})})},n.handleSwitch=function(e){return function(){n.setState({step:e,imgSent:!1})}},n.captureImage=function(e,t){var a=e.getContext("2d"),i=e.width;a.drawImage(t,0,0,i,e.height),t.srcObject.getVideoTracks().forEach(function(e){e.stop()});var r=ze(e.toDataURL("image/jpeg",.5));n.setState({imgSent:!0,img:r})},n.renderStep=function(e){var t=n.props.classes,a=n.state,r=a.imgSent,o=a.camera,s={shortText:a.shortText,geo:a.geo};switch(e){case 1:return i.a.createElement($e,{captureImage:n.captureImage,imgSent:r,camera:o});case 2:return i.a.createElement(rt,{handleAddFile:n.handleAddFile});case 3:return i.a.createElement("div",{className:t.container},i.a.createElement(tt,{handleChange:n.handleChange,values:s}),i.a.createElement(Se.a,{variant:"contained",color:"primary",className:t.button,onClick:n.handleSend},"Opublikuj"));default:return i.a.createElement($e,{captureImage:n.captureImage,imgSent:r,camera:o})}},n.state={imageId:"",id:"",user:null,data:"",img:"",geo:"",shortText:"",longText:"",step:2,imgSent:!1,camera:!1,loaded:"beforeSend",subscriptions:[]},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getCity",value:function(e,t){return fetch("https://us1.locationiq.com/v1/reverse.php?key=2c35b6ae22579a&lat="+e+"&lon="+t+"&format=json",{async:!0,crossDomain:!0,method:"GET"}).then(function(e){return e.json()}).then(function(e){return e.address.city||e.address.town})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.user;if("geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(t){e.getCity(t.coords.latitude,t.coords.longitude).then(function(t){e.setState({geo:t})})},function(e){console.log(e)}),"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices&&this.setState({camera:!0,step:1}),t){var n="";this.usersRef=G.database().ref("users/"+t.uid),this.usersRef.on("value",function(a){(n=a.val().color)&&e.setState({user:{id:t.uid,name:t.displayName,color:n}})})}this.getSubscriptions()}},{key:"componentWillReceiveProps",value:function(e){e.user!==this.props.user&&this.setState({user:{id:e.user.uid,name:e.user.displayName}})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.step,a=t.imgSent,r=t.camera,o=t.loaded;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{handleSwitch:this.handleSwitch,imgSent:a,step:n}),i.a.createElement("div",{className:f(e.layout,e.cardGrid)},i.a.createElement(E.a,{container:!0,spacing:0},i.a.createElement(E.a,{item:!0,xs:12},i.a.createElement("form",{noValidate:!0,autoComplete:"off"},this.renderStep(n))))),o?"":i.a.createElement("div",{className:e.center},i.a.createElement(Se.b,{className:e.progress,size:30,thickness:5})),i.a.createElement(Ae,{handleSwitch:this.handleSwitch,step:n,camera:r}))}}]),t}(a.PureComponent),lt=Object(g.withStyles)(function(e){return{layout:Object(p.a)({width:"auto",marginLeft:0,marginRight:0},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto"}),container:Object(p.a)({padding:40},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:500,marginLeft:"auto",marginRight:"auto"}),form:Object(qe.a)({},e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit}),textField:{width:"100%"},button:{width:"100%",marginTop:15,height:50},center:{width:"100%",height:"100vh",position:"absolute",left:0,top:0,display:"flex",justifyContent:"center",alignItems:"center",background:"rgba(255,255,255,.5)",zIndex:1}}})(ct),ut=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.location.pathname!==e.location.pathname&&window.scrollTo(0,0)}},{key:"render",value:function(){return null}}]),t}(a.Component),dt=Object(H.a)(ut),pt=n(114),mt=n.n(pt),ht=n(54),gt=n.n(ht),ft=n(43),bt=n.n(ft),vt=n(53),Et=n.n(vt),yt=n(278),wt=n.n(yt),At=n(42),jt=n.n(At),Ot=n(8),kt=n.n(Ot),xt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){return function(t){n.setState(Object(p.a)({},e,t.target.value))}},n.catchError=function(e){alert(e.message)},n.login=function(e,t){Z.setPersistence(G.auth.Auth.Persistence.SESSION).then(function(){return G.auth().signInWithEmailAndPassword(e,t)}).then(function(){n.props.history.push("/")}).catch(function(e){n.catchError(e)})},n.register=function(e,t){Z.createUserWithEmailAndPassword(e,t).catch(function(e){n.catchError(e)}).then(function(){Z.currentUser.updateProfile({displayName:n.state.username});var t=Z.currentUser.uid,a=G.database().ref("users/"+t),i=n.getUserColor(),r={id:t,username:n.state.username,email:e,push:!1,subscription:!1,color:i};a.set(r).then(function(){n.props.history.push("/")})})},n.getUserColor=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},n.toggleType=function(){n.setState(function(e){return{type:"login"===e.type?"register":"login"}})},n.handleSubmit=function(e){var t=n.state,a=t.login,i=t.password;"login"===e?n.login(a,i):n.register(a,i)},n.state={login:"",password:"",username:"",user:null,type:"login"},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){this.setState({login:"",password:"",username:"",user:null})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state.type,a="login"===n?"Zaloguj si\u0119":"Zarejestruj si\u0119",r="login"===n?"Nie masz jeszcze konta?":"Masz ju\u017c konto?";return i.a.createElement("main",{className:t.main},i.a.createElement(Ze,{loggedOut:!0}),i.a.createElement(mt.a,null),i.a.createElement(jt.a,{className:t.paper},i.a.createElement(R.a,{className:t.avatar},i.a.createElement(wt.a,null)),i.a.createElement(I.a,{component:"h1",variant:"h5"},a),i.a.createElement("form",{className:t.form},i.a.createElement(gt.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(Et.a,{htmlFor:"email"},"Email"),i.a.createElement(bt.a,{id:"email",name:"email",autoComplete:"email",autoFocus:!0,onChange:this.handleChange("login")})),i.a.createElement(gt.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(Et.a,{htmlFor:"password"},"Has\u0142o"),i.a.createElement(bt.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",onChange:this.handleChange("password")})),"register"===n?i.a.createElement(gt.a,{margin:"normal",required:!0,fullWidth:!0},i.a.createElement(Et.a,{htmlFor:"email"},"Login"),i.a.createElement(bt.a,{id:"username",name:"username",onChange:this.handleChange("username")})):"",i.a.createElement(at.a,{fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:function(){return e.handleSubmit(n)}},a),i.a.createElement("small",{className:t.typeLink},r,i.a.createElement(at.a,{color:"primary",className:t.button,onClick:this.toggleType},a)))),i.a.createElement(Ae,{loggedOut:!0}))}}]),t}(a.Component),Nt=kt()(function(e){return{main:Object(p.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:5*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,backgroundColor:J},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},typeLink:{marginTop:20,display:"flex",flexDirection:"column",textAlign:"center"}}})(xt),St=(n(675),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getPost=function(e){var t,i=a.props.id;"indexedDB"in window&&A("posts").then(function(e){for(var n in e)e[n].id===i&&(t=e[n]);a.setState({post:t,loaded:!0})}),new(n(120).default.JSONClient)("https://spot-pwa.firebaseio.com",{auth:e}).get("/posts/"+i).then(function(e){t=e.body,a.setState({post:t,loaded:!0})}).catch(function(e){return console.log(e)})},a.state={loaded:!1,post:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authFirebaseListener=Z.onAuthStateChanged(function(t){t&&t.getIdToken().then(function(t){e.getPost(t)})})}},{key:"componentWillUnmount",value:function(){this.authFirebaseListener&&this.authFirebaseListener()}},{key:"render",value:function(){return this.props.children(this.state.post,this.state.loaded)}}]),t}(a.PureComponent)),Ct=n(118),Ft=n(80),Lt=n.n(Ft),Rt=n(82),Tt=n.n(Rt),It=n(83),Kt=n.n(It),Ut=n(115),Pt=n.n(Ut),Bt=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleDelete=function(e){return function(){window.history.go(-1),G.database().ref("posts/"+e).remove()}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.onClose,a=(e.selectedValue,e.id),r=Object(Ct.a)(e,["classes","onClose","selectedValue","id"]);return i.a.createElement(Pt.a,Object.assign({onClose:function(){return n()},"aria-labelledby":"simple-dialog-title"},r),i.a.createElement("div",null,i.a.createElement(Lt.a,{className:t.actionList},i.a.createElement(Tt.a,{button:!0,className:t.border,onClick:this.handleDelete(a)},i.a.createElement(Kt.a,{primary:"Usu\u0144",className:t.action})),i.a.createElement(Tt.a,{button:!0,onClick:n},i.a.createElement(Kt.a,{primary:"Anuluj",className:t.action})))))}}]),t}(a.Component),Zt=Object(g.withStyles)(function(e){return{action:{textAlign:"center",padding:0,minWidth:200},actionList:{padding:0},border:{borderBottom:"1px solid "+z}}})(Bt),Gt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClickOpen=function(){n.setState({open:!0})},n.handleClose=function(e){n.setState({selectedValue:e,open:!1})},n.state={open:!1,selectedValue:""},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.id,a=t.classes,r=t.user;t.auth;return i.a.createElement(i.a.Fragment,null,i.a.createElement(St,{id:n},function(t,o){return o?t.user?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{singlePost:!0,openActions:t.user.id===r.uid&&e.handleClickOpen}),t.user.id===r.uid?i.a.createElement(Zt,{selectedValue:e.state.selectedValue,open:e.state.open,onClose:e.handleClose,id:n}):"",i.a.createElement("div",{className:a.layout},i.a.createElement(oe,{content:t}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{onlyBack:!0}),i.a.createElement(Se.j,{variant:"subheading",className:a.center},"Ten post nie istnieje!")):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{singlePost:!0}),i.a.createElement("div",{className:a.layout},i.a.createElement("div",{className:a.center},i.a.createElement(Se.b,{className:a.progress,size:30,thickness:5}))))}),i.a.createElement(Ae,null))}}]),t}(a.Component),Dt=Object(g.withStyles)(function(e){return{center:{width:"100%",height:"100vh",position:"absolute",left:0,top:0,display:"flex",justifyContent:"center",alignItems:"center"},layout:Object(p.a)({},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:1100,marginLeft:"auto",marginRight:"auto"})}})(Gt),Vt=n(116),Wt=n.n(Vt),qt=n(113),Ht=n.n(qt),Mt=n(117),zt=n.n(Mt),Jt=n(279),Yt=n.n(Jt),Xt=n(281),Qt=function(e){var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t);return Uint8Array.from(Object(Xt.a)(n).map(function(e){return e.charCodeAt(0)}))},_t=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleToggle=function(){var e=n.state.push;n.setState({push:!e}),!1===e?n.askForNotificationPermission():n.disableNotifications()},n.configurePushSubscription=function(){var e;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){return e=t,t.pushManager.getSubscription()}).then(function(t){if(null===t){var n=Qt("BCpge7IV7kIBHpMQ1ahqFVC0TzobN3sqkN_C5hk3LTrU5ytxj4o2ozTA_vxU-ZHZW8HW0Ldw9JJPfLX6hg-lPkA");e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})}return t}).then(function(e){return n.setState({subscription:e},function(){n.handleUpdateFirebase(),n.displayConfirmNotification()}),!0}).catch(function(e){console.log(e)})},n.askForNotificationPermission=function(){Notification.requestPermission(function(e){"granted"!==e||n.configurePushSubscription()})},n.disableNotifications=function(){n.setState({push:!1,subscription:!1},function(){n.handleUpdateFirebase()})},n.displayConfirmNotification=function(){if("serviceWorker"in navigator){var e={body:"Od teraz b\u0119dziesz otrzymywa\u0107 powiadomienie gdy kto\u015b doda nowy post :)",icon:"img/icons/icon-96x96.png",vibrate:[100,50,200],badge:"img/icons/icon-96x96.png",tag:"confirm-notification",renotify:!1,actions:[{action:"confrim",title:"OK"}]};navigator.serviceWorker.ready.then(function(t){t.showNotification("W\u0142\u0105czono powiadomienia!",e)})}},n.getUserSubscription=function(e){n.userRef=G.database().ref("users/"+e),n.userRef.on("value",function(e){var t=e.val().subscription,a=e.val().push;n.setState({push:a,subscription:t})})},n.handleUpdateFirebase=function(){var e=n.state.user.uid;G.database().ref("users/"+e).update({push:n.state.push,subscription:n.state.subscription})},n.state={user:null,push:!1,subscription:!1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillUpdate",value:function(e,t){e.user!==this.props.user&&(this.setState({user:e.user}),this.getUserSubscription(e.user.uid))}},{key:"render",value:function(){var e=this,t=this.state.push,n=this.props.classes;return i.a.createElement(Se.e,{className:n.pushToggle},i.a.createElement("div",{className:n.expanded},i.a.createElement(Se.j,{className:n.secondaryHeading},"Powiadomienia"),i.a.createElement("div",{className:n.form},i.a.createElement(Se.h,{checked:t,onChange:function(){return e.handleToggle()},value:!t}))))}}]),t}(a.Component),$t=Object(g.withStyles)(function(e){return{pushToggle:Object(p.a)({marginTop:15,marginBottom:15,background:_,borderBottom:"1px solid "+z+" !important",borderTop:"1px solid "+z+" !important",paddingBottom:10},e.breakpoints.up(1100+3*e.spacing.unit*2),{borderLeft:"1px solid "+z+" !important",borderRight:"1px solid "+z+" !important"}),expanded:{width:"100%"},secondaryHeading:{width:"50%",float:"left",padding:"15px 0"},form:{width:"50%",float:"right",textAlign:"right",display:"flex",justifyContent:"flex-end"}}})(_t),en=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleExpand=function(e){return function(t){n.setState({expanded:!!t&&e})}},n.handleLogout=function(){G.auth().signOut().then(function(){window.location.reload()})},n.handleEdit=function(e){return function(t){n.setState(Object(p.a)({},e,t.target.value))}},n.handleUpdateFirebase=function(e){return function(){var t=n.state.user;"email"===e?(G.database().ref("users/"+t.uid).update({email:n.state.newEmail}),G.auth().currentUser.updateEmail(n.state.newEmail)):"login"===e&&(G.database().ref("users/"+t.uid).update({username:n.state.newLogin}),G.auth().currentUser.updateProfile({displayName:n.state.newLogin})),n.setState({expanded:null})}},n.state={user:null,expanded:null,login:null,email:null,password:null,newLogin:null,newEmail:null,newPassword:null,push:!1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authFirebaseListener=Z.onAuthStateChanged(function(t){e.setState({user:t,login:t.displayName,email:t.email})})}},{key:"componentWillUnmount",value:function(){this.authFirebaseListener&&this.authFirebaseListener()}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.expanded,r=n.login,o=n.email,s=n.user,c=[{type:"login",new:"newLogin",heading:"Login",placeholder:r,description:"Zmie\u0144 nazw\u0119 u\u017cytkownika:"},{type:"email",new:"newEmail",heading:"Email",placeholder:o,description:"Zmie\u0144 sw\xf3j adres e-mail:"},{type:"password",new:"newPassword",heading:"Zmie\u0144 has\u0142o",placeholder:"",description:"Zmie\u0144 has\u0142o:"}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,{onlyBack:!0}),i.a.createElement("div",{className:t.root},c.map(function(n,r){return i.a.createElement(Wt.a,{key:r,expanded:a==="panel"+(r+1),onChange:e.toggleExpand("panel"+(r+1)),className:t.panel},i.a.createElement(zt.a,{expandIcon:i.a.createElement(Yt.a,null)},i.a.createElement(I.a,{className:t.heading},n.heading),i.a.createElement(I.a,{className:t.secondaryHeading},n.placeholder)),i.a.createElement("div",null,i.a.createElement(Ht.a,null,i.a.createElement("div",{className:t.expanded},i.a.createElement(I.a,{className:t.secondaryHeading},n.description),i.a.createElement("div",{className:t.form},i.a.createElement(Se.i,{id:"outlined-name-".concat(r),label:n.heading,className:t.textField,onChange:e.handleEdit(n.new),margin:"normal",variant:"outlined",type:"password"===n.type?"password":"text"})))),i.a.createElement(Se.c,null),i.a.createElement(Se.d,null,i.a.createElement(Se.a,{size:"small",onClick:e.toggleExpand("panel"+(r+1))},"Anuluj"),i.a.createElement(Se.a,{size:"small",color:"primary",onClick:e.handleUpdateFirebase(n.type)},"Zapisz"))))}),"Notification"in window?i.a.createElement($t,{user:s}):"",i.a.createElement(Se.a,{className:b()(t.panelButton,t.red),onClick:this.handleLogout},"Wyloguj si\u0119")),i.a.createElement(Ae,null))}}]),t}(a.Component),tn=Object(g.withStyles)(function(e){return{root:Object(p.a)({width:"100%",overflowX:"hidden",minHeight:"-webkit-fill-available"},e.breakpoints.up(1100+3*e.spacing.unit*2),{width:800,marginLeft:"auto",marginRight:"auto"}),panel:Object(p.a)({margin:"15px 0 !important",boxShadow:"none",borderBottom:"1px solid "+z+" !important",borderTop:"1px solid "+z+" !important"},e.breakpoints.up(1100+3*e.spacing.unit*2),{borderLeft:"1px solid "+z+" !important",borderRight:"1px solid "+z+" !important"}),panelButton:Object(p.a)({boxShadow:"none",borderBottom:"1px solid "+z+" !important",borderTop:"1px solid "+z+" !important",width:"100%",textAlign:"left",padding:"15px 24px",justifyContent:"flex-start",textTransform:"none",fontWeight:"normal",marginBottom:15,background:_},e.breakpoints.up(1100+3*e.spacing.unit*2),{borderLeft:"1px solid "+z+" !important",borderRight:"1px solid "+z+" !important"}),red:{color:X},heading:{flexBasis:"40%",flexShrink:0},secondaryHeading:{color:Q},textField:{margin:0,width:"100%",borderRadius:"4px 0 0 4px"},form:{width:"100%",display:"flex",justifyContent:"space-between",marginTop:15},expanded:{width:"100%"},iconSmall:{color:J},button:{background:M,border:"1px solid rgba(0, 0, 0, .2)",borderLeft:0,borderRadius:"0 4px 4px 0"}}})(en),nn=n(280),an=n.n(nn),rn=function(e){var t=e.isLogged,n=e.user,a=e.component,r=Object(Ct.a)(e,["isLogged","user","component"]);return i.a.createElement(m.a,Object.assign({},r,{render:function(e){return t?i.a.createElement(a,Object.assign({},e,{user:n})):i.a.createElement(an.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},on=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{className:e.center},i.a.createElement("img",{src:"img/icons/icon-144x144.png",alt:""}))}}]),t}(a.Component),sn=Object(g.withStyles)(function(e){return{center:{width:"100%",height:"100vh",position:"absolute",left:0,top:0,display:"flex",justifyContent:"center",alignItems:"center",background:M,zIndex:1}}})(on),cn=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).getAppContent=function(){var e=n.state,t=e.user,a=e.isLogged,r=e.loading,o=e.auth,s=n.props.classes;return r?i.a.createElement(sn,null):i.a.createElement("div",{className:s.container},i.a.createElement(dt,null),i.a.createElement(m.a,{auth:o,exact:!0,path:"/",component:Ge}),i.a.createElement(m.a,{auth:o,exact:!0,path:"/post/:id",component:function(e){var n=e.match;return i.a.createElement(Dt,{id:n.params.id,user:t})}}),i.a.createElement(rn,{isLogged:a,exact:!0,path:"/profile",component:We,user:t}),i.a.createElement(rn,{isLogged:a,exact:!0,path:"/add",component:lt,user:t}),i.a.createElement(rn,{isLogged:a,exact:!0,path:"/settings",component:tn,user:t}),i.a.createElement(m.a,{exact:!0,path:"/login",component:Nt}))},n.state={user:null,isLogged:!1,loading:!0,auth:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authFirebaseListener=Z.onAuthStateChanged(function(t){t&&t.getIdToken().then(function(n){e.setState({user:t,isLogged:!0,auth:n})}),e.setState({loading:!1})})}},{key:"componentWillUnmount",value:function(){this.authFirebaseListener&&this.authFirebaseListener()}},{key:"render",value:function(){return i.a.createElement(h.a,{basename:"/spotick"},this.getAppContent())}}]),t}(a.Component),ln=Object(g.withStyles)(function(e){return{container:Object(p.a)({paddingTop:50,paddingBottom:50,minHeight:"100vh",boxSizing:"border-box"},e.breakpoints.up("sm"),{paddingTop:80})}})(cn);o.a.render(i.a.createElement(ln,null),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("https://totoczko.github.io"===window.location.origin?"https://totoczko.github.io/spotick/sw.js":"http://localhost:3000/sw.js")})}},[[339,2,1]]]);
//# sourceMappingURL=main.f8730d44.chunk.js.map